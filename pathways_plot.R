library(tidyverse)
library(scales)
#WL plot
#Tno
current_WL <-
  tibble::tribble(
    ~Week_Ending_Date,  ~BSOL,  ~UHB,  ~ROH,
         "02/10/2022", 10428L, 6963L, 2820L,
         "09/10/2022", 10414L, 6981L, 2813L,
         "16/10/2022", 10314L, 6884L, 2875L,
         "23/10/2022",  9924L, 6440L, 2936L,
         "30/10/2022", 10050L, 6568L, 2902L,
         "06/11/2022", 10046L, 6565L, 2897L,
         "13/11/2022", 10073L, 6511L, 2893L,
         "20/11/2022",  9951L, 6443L, 2857L,
         "27/11/2022",  9924L, 6357L, 2913L,
         "04/12/2022", 10036L, 6291L, 3010L,
         "11/12/2022",  9723L, 5935L, 3159L,
         "18/12/2022",  9733L, 5878L, 3258L,
         "25/12/2022",  9651L, 5828L, 3224L,
         "01/01/2023",  9542L, 5774L, 3185L,
         "08/01/2023",  9541L, 5776L, 3190L,
         "15/01/2023",  9612L, 5619L, 3416L,
         "22/01/2023",  6583L, 2598L, 3414L,
         "29/01/2023",   551L,    NA,    NA,
         "05/02/2023",  9445L, 5276L, 3465L,
         "12/02/2023",  9255L, 5117L, 3358L,
         "19/02/2023",  7586L, 3512L, 3351L,
         "26/02/2023",  9099L, 5078L, 3319L,
         "05/03/2023",  9082L, 5020L, 3338L,
         "12/03/2023",  9194L, 5022L, 3439L,
         "19/03/2023",  9176L, 5052L, 3443L,
         "26/03/2023",  9153L, 4967L, 3529L,
         "02/04/2023",  9018L, 4993L, 3488L,
         "09/04/2023",  9277L, 4983L, 3530L,
         "16/04/2023",  9361L, 5021L, 3595L,
         "23/04/2023",  9082L, 5043L, 3655L,
         "30/04/2023",  9471L, 5049L, 3743L,
         "07/05/2023",  9359L, 4989L, 3692L,
         "14/05/2023",  9250L, 4991L, 3595L,
         "21/05/2023",  9286L, 4968L, 3692L,
         "28/05/2023",  9275L, 4920L, 3726L,
         "04/06/2023",  9223L, 4870L, 3693L,
         "11/06/2023",  8970L, 4761L, 3640L,
         "18/06/2023",  9075L, 4718L, 3751L,
         "25/06/2023",  9020L, 4672L, 3726L,
         "02/07/2023",  8950L, 4633L, 3679L,
         "09/07/2023",  8924L, 4492L, 3737L,
         "16/07/2023",  8876L, 4380L, 3799L,
         "23/07/2023",  8765L, 4421L, 3875L,
         "30/07/2023",  8923L, 4349L, 3890L,
         "06/08/2023",  8916L, 4259L, 3949L,
         "13/08/2023",  8910L, 4240L, 3938L,
         "20/08/2023",  8860L, 4227L, 3936L,
         "27/08/2023",  8828L, 4265L, 3889L,
         "03/09/2023",  8755L, 4189L, 3894L,
         "10/09/2023",  8562L, 4037L, 3842L,
         "17/09/2023",  8475L, 4052L, 3766L,
         "24/09/2023",  8697L, 3993L, 4036L,
         "01/10/2023",  8588L, 3874L, 4018L,
         "08/10/2023",  8594L, 3817L, 4081L,
         "15/10/2023",  8461L, 3767L, 4045L,
         "22/10/2023",  8274L, 3602L, 4020L,
         "29/10/2023",  8204L, 3543L, 3984L,
         "05/11/2023",  8219L, 3536L, 3985L,
         "12/11/2023",  8091L, 3497L, 3940L,
         "19/11/2023",  7896L, 3363L, 3920L,
         "26/11/2023",  7751L, 3227L, 3881L,
         "03/12/2023",  7633L, 3121L, 3887L,
         "10/12/2023",  7537L, 3046L, 3858L,
         "17/12/2023",  7355L, 2965L, 3802L,
         "24/12/2023",  7294L, 2874L, 3839L,
         "31/12/2023",  7289L, 2843L, 3869L,
         "07/01/2024",  7170L, 2766L, 3856L,
         "14/01/2024",  7103L, 2664L, 3852L,
         "21/01/2024",  7037L, 2616L, 3807L,
         "28/01/2024",  6861L, 2502L, 3757L,
         "04/02/2024",  6819L, 2466L, 3748L,
         "11/02/2024",  6771L, 2390L, 3759L,
         "18/02/2024",  6782L, 2380L, 3798L,
         "25/02/2024",  6779L, 2352L, 3803L,
         "03/03/2024",  6684L, 2295L, 3807L,
         "10/03/2024",  6318L, 2284L, 3459L,
         "17/03/2024",  6265L, 2208L, 3555L,
         "24/03/2024",  6172L, 2187L, 3469L,
         "31/03/2024",  6224L, 2195L, 3493L,
         "07/04/2024",  6275L, 2174L, 3551L,
         "14/04/2024",  6144L, 2145L, 3475L,
         "21/04/2024",  5763L, 2110L, 3435L,
         "28/04/2024",  6036L, 2065L, 3446L,
         "05/05/2024",  6014L, 2058L, 3463L,
         "12/05/2024",  5945L, 2031L, 3437L,
         "19/05/2024",  5769L, 2049L, 3519L,
         "26/05/2024",  5947L, 2003L, 3429L,
         "02/06/2024",  5886L, 1933L, 3378L,
         "09/06/2024",  5755L, 1943L, 3277L,
         "16/06/2024",  5784L, 2011L, 3245L,
         "23/06/2024",  5676L, 1930L, 3238L,
         "30/06/2024",  5821L, 1974L, 3340L,
         "07/07/2024",  5833L, 1950L, 3378L,
         "14/07/2024",  5697L, 1885L, 3291L,
         "21/07/2024",  5609L, 1760L, 3306L,
         "28/07/2024",  5792L, 1851L, 3328L,
         "04/08/2024",  5814L, 1832L, 3380L,
         "11/08/2024",  5850L, 1783L, 3441L,
         "18/08/2024",  5859L, 1750L, 3523L,
         "25/08/2024",  5858L, 1743L, 3466L,
         "01/09/2024",  2404L, 1733L,    NA,
         "08/09/2024",  5698L, 1642L, 3405L,
         "15/09/2024",  5608L, 1629L, 3302L,
         "22/09/2024",  5456L, 1637L, 3162L,
         "29/09/2024",  5310L, 1597L, 3029L
    )

current_WL$Week_Ending_Date = as.Date(current_WL$Week_Ending_Date, "%d/%m/%Y")

current_WL %>% 
  pivot_longer(cols = -Week_Ending_Date) %>% 
  ggplot(aes(x=Week_Ending_Date, y = value, col = name, group = name)) +
  geom_line()+
  geom_smooth()+
  scale_colour_viridis_d("Group")+
  scale_y_continuous("Open Pathways",labels = comma)+
  scale_x_date("Week Ending Date", date_labels = "%b-%y", date_breaks = "3 month")+
  labs(title = "Open T&O pathways per week",
       subtitle = "Weekly reported data, and smoothed trend") +
  theme(plot.title = element_text(face="bold"))



#WL plot
#Urology
current_WL_urology <-
  tibble::tribble(
     ~Week_Ending_Date, ~Pathways_Quantity,   ~Org,
          "02/10/2022",              6919L, "BSOL",
          "09/10/2022",              6879L, "BSOL",
          "16/10/2022",              6870L, "BSOL",
          "23/10/2022",              6881L, "BSOL",
          "30/10/2022",              7036L, "BSOL",
          "06/11/2022",              6949L, "BSOL",
          "13/11/2022",              6847L, "BSOL",
          "20/11/2022",              6793L, "BSOL",
          "27/11/2022",              6769L, "BSOL",
          "04/12/2022",              6795L, "BSOL",
          "11/12/2022",              6803L, "BSOL",
          "18/12/2022",              6679L, "BSOL",
          "25/12/2022",              6615L, "BSOL",
          "01/01/2023",              6652L, "BSOL",
          "08/01/2023",              6646L, "BSOL",
          "15/01/2023",              6595L, "BSOL",
          "22/01/2023",              3752L, "BSOL",
          "29/01/2023",                 NA, "BSOL", # censored for <10
          "05/02/2023",              6372L, "BSOL",
          "12/02/2023",              6320L, "BSOL",
          "19/02/2023",              4333L, "BSOL",
          "26/02/2023",              6210L, "BSOL",
          "05/03/2023",              6391L, "BSOL",
          "12/03/2023",              6474L, "BSOL",
          "19/03/2023",              6443L, "BSOL",
          "26/03/2023",              6464L, "BSOL",
          "02/04/2023",              6329L, "BSOL",
          "09/04/2023",              6241L, "BSOL",
          "16/04/2023",              6166L, "BSOL",
          "23/04/2023",              6220L, "BSOL",
          "30/04/2023",              6243L, "BSOL",
          "07/05/2023",              6148L, "BSOL",
          "14/05/2023",              6068L, "BSOL",
          "21/05/2023",              6033L, "BSOL",
          "28/05/2023",              6018L, "BSOL",
          "04/06/2023",              6133L, "BSOL",
          "11/06/2023",              6006L, "BSOL",
          "18/06/2023",              5948L, "BSOL",
          "25/06/2023",              5921L, "BSOL",
          "02/07/2023",              5932L, "BSOL",
          "09/07/2023",              5999L, "BSOL",
          "16/07/2023",              5982L, "BSOL",
          "23/07/2023",              6017L, "BSOL",
          "30/07/2023",              5908L, "BSOL",
          "06/08/2023",              5912L, "BSOL",
          "13/08/2023",              5926L, "BSOL",
          "20/08/2023",              5927L, "BSOL",
          "27/08/2023",              6009L, "BSOL",
          "03/09/2023",              6048L, "BSOL",
          "10/09/2023",              6037L, "BSOL",
          "17/09/2023",              6063L, "BSOL",
          "24/09/2023",              5891L, "BSOL",
          "01/10/2023",              5870L, "BSOL",
          "08/10/2023",              5910L, "BSOL",
          "15/10/2023",              5979L, "BSOL",
          "22/10/2023",              5888L, "BSOL",
          "29/10/2023",              5943L, "BSOL",
          "05/11/2023",              5791L, "BSOL",
          "12/11/2023",              5695L, "BSOL",
          "19/11/2023",              5591L, "BSOL",
          "26/11/2023",              5607L, "BSOL",
          "03/12/2023",              5610L, "BSOL",
          "10/12/2023",              5581L, "BSOL",
          "17/12/2023",              5596L, "BSOL",
          "24/12/2023",              5557L, "BSOL",
          "31/12/2023",              5537L, "BSOL",
          "07/01/2024",              5568L, "BSOL",
          "14/01/2024",              5531L, "BSOL",
          "21/01/2024",              5583L, "BSOL",
          "28/01/2024",              5375L, "BSOL",
          "04/02/2024",              5245L, "BSOL",
          "11/02/2024",              5286L, "BSOL",
          "18/02/2024",              5316L, "BSOL",
          "25/02/2024",              5395L, "BSOL",
          "03/03/2024",              5355L, "BSOL",
          "10/03/2024",              5332L, "BSOL",
          "17/03/2024",              5290L, "BSOL",
          "24/03/2024",              5202L, "BSOL",
          "31/03/2024",              5165L, "BSOL",
          "07/04/2024",              5234L, "BSOL",
          "14/04/2024",              5222L, "BSOL",
          "21/04/2024",              5270L, "BSOL",
          "28/04/2024",              5152L, "BSOL",
          "05/05/2024",              5032L, "BSOL",
          "12/05/2024",              4976L, "BSOL",
          "19/05/2024",              5022L, "BSOL",
          "26/05/2024",              4910L, "BSOL",
          "02/06/2024",              4994L, "BSOL",
          "09/06/2024",              4875L, "BSOL",
          "16/06/2024",              4684L, "BSOL",
          "23/06/2024",              4615L, "BSOL",
          "30/06/2024",              4575L, "BSOL",
          "07/07/2024",              4470L, "BSOL",
          "14/07/2024",              4419L, "BSOL",
          "21/07/2024",              4370L, "BSOL",
          "28/07/2024",              4384L, "BSOL",
          "04/08/2024",              4370L, "BSOL",
          "11/08/2024",              4322L, "BSOL",
          "18/08/2024",              4330L, "BSOL",
          "25/08/2024",              4278L, "BSOL",
          "01/09/2024",              4326L, "BSOL",
          "08/09/2024",              4282L, "BSOL",
          "15/09/2024",              4347L, "BSOL",
          "22/09/2024",              4360L, "BSOL",
          "29/09/2024",              4265L, "BSOL",
          "02/10/2022",              6903L,  "UHB",
          "09/10/2022",              6861L,  "UHB",
          "16/10/2022",              6854L,  "UHB",
          "23/10/2022",              6864L,  "UHB",
          "30/10/2022",              7024L,  "UHB",
          "06/11/2022",              6941L,  "UHB",
          "13/11/2022",              6838L,  "UHB",
          "20/11/2022",              6785L,  "UHB",
          "27/11/2022",              6761L,  "UHB",
          "04/12/2022",              6787L,  "UHB",
          "11/12/2022",              6795L,  "UHB",
          "18/12/2022",              6672L,  "UHB",
          "25/12/2022",              6608L,  "UHB",
          "01/01/2023",              6646L,  "UHB",
          "08/01/2023",              6640L,  "UHB",
          "15/01/2023",              6589L,  "UHB",
          "22/01/2023",              3746L,  "UHB",
          "29/01/2023",                 NA,  "UHB",
          "05/02/2023",              6367L,  "UHB",
          "12/02/2023",              6316L,  "UHB",
          "19/02/2023",              4332L,  "UHB",
          "26/02/2023",              6209L,  "UHB",
          "05/03/2023",              6390L,  "UHB",
          "12/03/2023",              6474L,  "UHB",
          "19/03/2023",              6443L,  "UHB",
          "26/03/2023",              6464L,  "UHB",
          "02/04/2023",              6329L,  "UHB",
          "09/04/2023",              6241L,  "UHB",
          "16/04/2023",              6166L,  "UHB",
          "23/04/2023",              6220L,  "UHB",
          "30/04/2023",              6242L,  "UHB",
          "07/05/2023",              6147L,  "UHB",
          "14/05/2023",              6068L,  "UHB",
          "21/05/2023",              6032L,  "UHB",
          "28/05/2023",              6018L,  "UHB",
          "04/06/2023",              6132L,  "UHB",
          "11/06/2023",              6006L,  "UHB",
          "18/06/2023",              5948L,  "UHB",
          "25/06/2023",              5921L,  "UHB",
          "02/07/2023",              5932L,  "UHB",
          "09/07/2023",              5999L,  "UHB",
          "16/07/2023",              5982L,  "UHB",
          "23/07/2023",              6017L,  "UHB",
          "30/07/2023",              5901L,  "UHB",
          "06/08/2023",              5905L,  "UHB",
          "13/08/2023",              5919L,  "UHB",
          "20/08/2023",              5920L,  "UHB",
          "27/08/2023",              6002L,  "UHB",
          "03/09/2023",              6041L,  "UHB",
          "10/09/2023",              6029L,  "UHB",
          "17/09/2023",              6055L,  "UHB",
          "24/09/2023",              5883L,  "UHB",
          "01/10/2023",              5863L,  "UHB",
          "08/10/2023",              5907L,  "UHB",
          "15/10/2023",              5976L,  "UHB",
          "22/10/2023",              5883L,  "UHB",
          "29/10/2023",              5938L,  "UHB",
          "05/11/2023",              5785L,  "UHB",
          "12/11/2023",              5689L,  "UHB",
          "19/11/2023",              5589L,  "UHB",
          "26/11/2023",              5602L,  "UHB",
          "03/12/2023",              5604L,  "UHB",
          "10/12/2023",              5574L,  "UHB",
          "17/12/2023",              5591L,  "UHB",
          "24/12/2023",              5551L,  "UHB",
          "31/12/2023",              5531L,  "UHB",
          "07/01/2024",              5559L,  "UHB",
          "14/01/2024",              5521L,  "UHB",
          "21/01/2024",              5575L,  "UHB",
          "28/01/2024",              5366L,  "UHB",
          "04/02/2024",              5239L,  "UHB",
          "11/02/2024",              5280L,  "UHB",
          "18/02/2024",              5311L,  "UHB",
          "25/02/2024",              5390L,  "UHB",
          "03/03/2024",              5351L,  "UHB",
          "10/03/2024",              5328L,  "UHB",
          "17/03/2024",              5284L,  "UHB",
          "24/03/2024",              5195L,  "UHB",
          "31/03/2024",              5158L,  "UHB",
          "07/04/2024",              5227L,  "UHB",
          "14/04/2024",              5214L,  "UHB",
          "21/04/2024",              5261L,  "UHB",
          "28/04/2024",              5146L,  "UHB",
          "05/05/2024",              5028L,  "UHB",
          "12/05/2024",              4970L,  "UHB",
          "19/05/2024",              5016L,  "UHB",
          "26/05/2024",              4906L,  "UHB",
          "02/06/2024",              4989L,  "UHB",
          "09/06/2024",              4870L,  "UHB",
          "16/06/2024",              4676L,  "UHB",
          "23/06/2024",              4607L,  "UHB",
          "30/06/2024",              4570L,  "UHB",
          "07/07/2024",              4468L,  "UHB",
          "14/07/2024",              4415L,  "UHB",
          "21/07/2024",              4365L,  "UHB",
          "28/07/2024",              4377L,  "UHB",
          "04/08/2024",              4365L,  "UHB",
          "11/08/2024",              4320L,  "UHB",
          "18/08/2024",              4327L,  "UHB",
          "25/08/2024",              4275L,  "UHB",
          "01/09/2024",              4322L,  "UHB",
          "08/09/2024",              4276L,  "UHB",
          "15/09/2024",              4342L,  "UHB",
          "22/09/2024",              4356L,  "UHB",
          "29/09/2024",              4263L,  "UHB"
     )



current_WL_urology$Week_Ending_Date = as.Date(current_WL_urology$Week_Ending_Date, "%d/%m/%Y")

current_WL_urology %>% 
  #pivot_longer(cols = -Week_Ending_Date) %>% 
  ggplot(aes(x=Week_Ending_Date, y = Pathways_Quantity, col = Org, group = Org)) +
  geom_line()+
  geom_smooth()+
  scale_colour_viridis_d("Group")+
  scale_y_continuous("Open Pathways",labels = comma)+
  scale_x_date("Week Ending Date", date_labels = "%b-%y", date_breaks = "3 month")+
  labs(title = "Open Urology pathways per week",
       subtitle = "Weekly reported data, and smoothed trend") +
  theme(plot.title = element_text(face="bold"))




#WL plot
#ENT
current_WL_ENT <-
  tibble::tribble(
    ~Week_Ending_Date, ~Pathways_Quantity,   ~Org,
         "02/10/2022",             16420L, "BSOL",
         "09/10/2022",             16338L, "BSOL",
         "16/10/2022",             16236L, "BSOL",
         "23/10/2022",             16159L, "BSOL",
         "30/10/2022",             16643L, "BSOL",
         "06/11/2022",             16639L, "BSOL",
         "13/11/2022",             16508L, "BSOL",
         "20/11/2022",             16476L, "BSOL",
         "27/11/2022",             16189L, "BSOL",
         "04/12/2022",             16198L, "BSOL",
         "11/12/2022",             16133L, "BSOL",
         "18/12/2022",             15992L, "BSOL",
         "25/12/2022",             15766L, "BSOL",
         "01/01/2023",             15806L, "BSOL",
         "08/01/2023",             15782L, "BSOL",
         "15/01/2023",             15644L, "BSOL",
         "22/01/2023",              7795L, "BSOL",
         "29/01/2023",                 NA, "BSOL",
         "05/02/2023",             15259L, "BSOL",
         "12/02/2023",             15363L, "BSOL",
         "19/02/2023",             10340L, "BSOL",
         "26/02/2023",             15337L, "BSOL",
         "05/03/2023",             15511L, "BSOL",
         "12/03/2023",             15775L, "BSOL",
         "19/03/2023",             15843L, "BSOL",
         "26/03/2023",             15883L, "BSOL",
         "02/04/2023",             15901L, "BSOL",
         "09/04/2023",             15974L, "BSOL",
         "16/04/2023",             15927L, "BSOL",
         "23/04/2023",             15855L, "BSOL",
         "30/04/2023",             15794L, "BSOL",
         "07/05/2023",             15741L, "BSOL",
         "14/05/2023",             15678L, "BSOL",
         "21/05/2023",             15607L, "BSOL",
         "28/05/2023",             15407L, "BSOL",
         "04/06/2023",             15375L, "BSOL",
         "11/06/2023",             15310L, "BSOL",
         "18/06/2023",             15333L, "BSOL",
         "25/06/2023",             15283L, "BSOL",
         "02/07/2023",             15352L, "BSOL",
         "09/07/2023",             15345L, "BSOL",
         "16/07/2023",             15386L, "BSOL",
         "23/07/2023",             15302L, "BSOL",
         "30/07/2023",             15241L, "BSOL",
         "06/08/2023",             15278L, "BSOL",
         "13/08/2023",             15163L, "BSOL",
         "20/08/2023",             15149L, "BSOL",
         "27/08/2023",             15228L, "BSOL",
         "03/09/2023",             15014L, "BSOL",
         "10/09/2023",             14666L, "BSOL",
         "17/09/2023",             14610L, "BSOL",
         "24/09/2023",             14229L, "BSOL",
         "01/10/2023",             14023L, "BSOL",
         "08/10/2023",             13935L, "BSOL",
         "15/10/2023",             14044L, "BSOL",
         "22/10/2023",             14046L, "BSOL",
         "29/10/2023",             14198L, "BSOL",
         "05/11/2023",             14211L, "BSOL",
         "12/11/2023",             14152L, "BSOL",
         "19/11/2023",             14217L, "BSOL",
         "26/11/2023",             14120L, "BSOL",
         "03/12/2023",             13930L, "BSOL",
         "10/12/2023",             13947L, "BSOL",
         "17/12/2023",             13900L, "BSOL",
         "24/12/2023",             13889L, "BSOL",
         "31/12/2023",             14015L, "BSOL",
         "07/01/2024",             13967L, "BSOL",
         "14/01/2024",             13900L, "BSOL",
         "21/01/2024",             13649L, "BSOL",
         "28/01/2024",             13500L, "BSOL",
         "04/02/2024",             13238L, "BSOL",
         "11/02/2024",             13126L, "BSOL",
         "18/02/2024",             13210L, "BSOL",
         "25/02/2024",             13108L, "BSOL",
         "03/03/2024",             13112L, "BSOL",
         "10/03/2024",             13304L, "BSOL",
         "17/03/2024",             13225L, "BSOL",
         "24/03/2024",             13037L, "BSOL",
         "31/03/2024",             13228L, "BSOL",
         "07/04/2024",             13350L, "BSOL",
         "14/04/2024",             13408L, "BSOL",
         "21/04/2024",             13553L, "BSOL",
         "28/04/2024",             13586L, "BSOL",
         "05/05/2024",             13616L, "BSOL",
         "12/05/2024",             13649L, "BSOL",
         "19/05/2024",             13513L, "BSOL",
         "26/05/2024",             13613L, "BSOL",
         "02/06/2024",             13518L, "BSOL",
         "09/06/2024",             13335L, "BSOL",
         "16/06/2024",             13343L, "BSOL",
         "23/06/2024",             13213L, "BSOL",
         "30/06/2024",             13113L, "BSOL",
         "07/07/2024",             12844L, "BSOL",
         "14/07/2024",             12573L, "BSOL",
         "21/07/2024",             12229L, "BSOL",
         "28/07/2024",             12291L, "BSOL",
         "04/08/2024",             12105L, "BSOL",
         "11/08/2024",             11958L, "BSOL",
         "18/08/2024",             11734L, "BSOL",
         "25/08/2024",             11559L, "BSOL",
         "01/09/2024",             11675L, "BSOL",
         "08/09/2024",             11831L, "BSOL",
         "15/09/2024",             11833L, "BSOL",
         "22/09/2024",             11845L, "BSOL",
         "29/09/2024",             11846L, "BSOL",
         "02/10/2022",             16419L,  "UHB",
         "09/10/2022",             16337L,  "UHB",
         "16/10/2022",             16236L,  "UHB",
         "23/10/2022",             16159L,  "UHB",
         "30/10/2022",             16641L,  "UHB",
         "06/11/2022",             16637L,  "UHB",
         "13/11/2022",             16506L,  "UHB",
         "20/11/2022",             16475L,  "UHB",
         "27/11/2022",             16189L,  "UHB",
         "04/12/2022",             16198L,  "UHB",
         "11/12/2022",             16133L,  "UHB",
         "18/12/2022",             15992L,  "UHB",
         "25/12/2022",             15766L,  "UHB",
         "01/01/2023",             15806L,  "UHB",
         "08/01/2023",             15782L,  "UHB",
         "15/01/2023",             15643L,  "UHB",
         "22/01/2023",              7795L,  "UHB",
         "29/01/2023",                 NA,  "UHB",
         "05/02/2023",             15259L,  "UHB",
         "12/02/2023",             15363L,  "UHB",
         "19/02/2023",             10340L,  "UHB",
         "26/02/2023",             15337L,  "UHB",
         "05/03/2023",             15511L,  "UHB",
         "12/03/2023",             15775L,  "UHB",
         "19/03/2023",             15843L,  "UHB",
         "26/03/2023",             15883L,  "UHB",
         "02/04/2023",             15901L,  "UHB",
         "09/04/2023",             15974L,  "UHB",
         "16/04/2023",             15927L,  "UHB",
         "23/04/2023",             15855L,  "UHB",
         "30/04/2023",             15794L,  "UHB",
         "07/05/2023",             15741L,  "UHB",
         "14/05/2023",             15678L,  "UHB",
         "21/05/2023",             15607L,  "UHB",
         "28/05/2023",             15405L,  "UHB",
         "04/06/2023",             15375L,  "UHB",
         "11/06/2023",             15309L,  "UHB",
         "18/06/2023",             15332L,  "UHB",
         "25/06/2023",             15282L,  "UHB",
         "02/07/2023",             15351L,  "UHB",
         "09/07/2023",             15344L,  "UHB",
         "16/07/2023",             15385L,  "UHB",
         "23/07/2023",             15301L,  "UHB",
         "30/07/2023",             15240L,  "UHB",
         "06/08/2023",             15277L,  "UHB",
         "13/08/2023",             15162L,  "UHB",
         "20/08/2023",             15148L,  "UHB",
         "27/08/2023",             15227L,  "UHB",
         "03/09/2023",             15013L,  "UHB",
         "10/09/2023",             14665L,  "UHB",
         "17/09/2023",             14608L,  "UHB",
         "24/09/2023",             14228L,  "UHB",
         "01/10/2023",             14022L,  "UHB",
         "08/10/2023",             13934L,  "UHB",
         "15/10/2023",             14043L,  "UHB",
         "22/10/2023",             14045L,  "UHB",
         "29/10/2023",             14196L,  "UHB",
         "05/11/2023",             14210L,  "UHB",
         "12/11/2023",             14151L,  "UHB",
         "19/11/2023",             14216L,  "UHB",
         "26/11/2023",             14118L,  "UHB",
         "03/12/2023",             13928L,  "UHB",
         "10/12/2023",             13946L,  "UHB",
         "17/12/2023",             13899L,  "UHB",
         "24/12/2023",             13888L,  "UHB",
         "31/12/2023",             14014L,  "UHB",
         "07/01/2024",             13966L,  "UHB",
         "14/01/2024",             13899L,  "UHB",
         "21/01/2024",             13648L,  "UHB",
         "28/01/2024",             13498L,  "UHB",
         "04/02/2024",             13235L,  "UHB",
         "11/02/2024",             13123L,  "UHB",
         "18/02/2024",             13208L,  "UHB",
         "25/02/2024",             13106L,  "UHB",
         "03/03/2024",             13112L,  "UHB",
         "10/03/2024",             13304L,  "UHB",
         "17/03/2024",             13222L,  "UHB",
         "24/03/2024",             13035L,  "UHB",
         "31/03/2024",             13228L,  "UHB",
         "07/04/2024",             13350L,  "UHB",
         "14/04/2024",             13408L,  "UHB",
         "21/04/2024",             13553L,  "UHB",
         "28/04/2024",             13586L,  "UHB",
         "05/05/2024",             13616L,  "UHB",
         "12/05/2024",             13649L,  "UHB",
         "19/05/2024",             13513L,  "UHB",
         "26/05/2024",             13613L,  "UHB",
         "02/06/2024",             13518L,  "UHB",
         "09/06/2024",             13334L,  "UHB",
         "16/06/2024",             13341L,  "UHB",
         "23/06/2024",             13211L,  "UHB",
         "30/06/2024",             13111L,  "UHB",
         "07/07/2024",             12842L,  "UHB",
         "14/07/2024",             12569L,  "UHB",
         "21/07/2024",             12226L,  "UHB",
         "28/07/2024",             12288L,  "UHB",
         "04/08/2024",             12102L,  "UHB",
         "11/08/2024",             11956L,  "UHB",
         "18/08/2024",             11732L,  "UHB",
         "25/08/2024",             11557L,  "UHB",
         "01/09/2024",             11673L,  "UHB",
         "08/09/2024",             11828L,  "UHB",
         "15/09/2024",             11830L,  "UHB",
         "22/09/2024",             11843L,  "UHB",
         "29/09/2024",             11843L,  "UHB"
    )




current_WL_ENT$Week_Ending_Date = as.Date(current_WL_ENT$Week_Ending_Date, "%d/%m/%Y")

current_WL_ENT %>% 
  #pivot_longer(cols = -Week_Ending_Date) %>% 
  ggplot(aes(x=Week_Ending_Date, y = Pathways_Quantity, col = Org, group = Org)) +
  geom_line()+
  geom_smooth()+
  scale_colour_viridis_d("Group")+
  scale_y_continuous("Open Pathways",labels = comma)+
  scale_x_date("Week Ending Date", date_labels = "%b-%y", date_breaks = "3 month")+
  labs(title = "Open ENT pathways per week",
       subtitle = "Weekly reported data, and smoothed trend") +
  theme(plot.title = element_text(face="bold"))





#WL plot
#Gynae
current_WL_gynae <-
  tibble::tribble(
    ~Week_Ending_Date, ~Pathways_Quantity,   ~Org,
         "02/10/2022",             10253L, "BSOL",
         "09/10/2022",              7638L, "BSOL",
         "16/10/2022",             10487L, "BSOL",
         "23/10/2022",             10569L, "BSOL",
         "30/10/2022",             10759L, "BSOL",
         "06/11/2022",             10788L, "BSOL",
         "13/11/2022",             10893L, "BSOL",
         "20/11/2022",             10856L, "BSOL",
         "27/11/2022",             10815L, "BSOL",
         "04/12/2022",             10833L, "BSOL",
         "11/12/2022",             10844L, "BSOL",
         "18/12/2022",             10737L, "BSOL",
         "25/12/2022",             10709L, "BSOL",
         "01/01/2023",             10684L, "BSOL",
         "08/01/2023",             10673L, "BSOL",
         "15/01/2023",             10680L, "BSOL",
         "22/01/2023",              6970L, "BSOL",
         "29/01/2023",                52L, "BSOL",
         "05/02/2023",             10449L, "BSOL",
         "12/02/2023",             10420L, "BSOL",
         "19/02/2023",              4634L, "BSOL",
         "26/02/2023",              8304L, "BSOL",
         "05/03/2023",             10418L, "BSOL",
         "12/03/2023",             10447L, "BSOL",
         "19/03/2023",             10476L, "BSOL",
         "26/03/2023",             10405L, "BSOL",
         "02/04/2023",             10396L, "BSOL",
         "09/04/2023",             10386L, "BSOL",
         "16/04/2023",             10318L, "BSOL",
         "23/04/2023",             10243L, "BSOL",
         "30/04/2023",             10103L, "BSOL",
         "07/05/2023",              9916L, "BSOL",
         "14/05/2023",              9861L, "BSOL",
         "21/05/2023",              9648L, "BSOL",
         "28/05/2023",              9625L, "BSOL",
         "04/06/2023",              9466L, "BSOL",
         "11/06/2023",              9484L, "BSOL",
         "18/06/2023",              9486L, "BSOL",
         "25/06/2023",              9381L, "BSOL",
         "02/07/2023",              9218L, "BSOL",
         "09/07/2023",              9208L, "BSOL",
         "16/07/2023",              9210L, "BSOL",
         "23/07/2023",              9134L, "BSOL",
         "30/07/2023",              9061L, "BSOL",
         "06/08/2023",              6643L, "BSOL",
         "07/08/2023",              2214L, "BSOL",
         "13/08/2023",              8817L, "BSOL",
         "20/08/2023",              8749L, "BSOL",
         "27/08/2023",              6614L, "BSOL",
         "28/08/2023",              2070L, "BSOL",
         "03/09/2023",              8595L, "BSOL",
         "10/09/2023",              8421L, "BSOL",
         "17/09/2023",              8308L, "BSOL",
         "24/09/2023",              8376L, "BSOL",
         "01/10/2023",              8104L, "BSOL",
         "08/10/2023",              7948L, "BSOL",
         "15/10/2023",              7898L, "BSOL",
         "22/10/2023",              7652L, "BSOL",
         "29/10/2023",              7336L, "BSOL",
         "05/11/2023",              7451L, "BSOL",
         "12/11/2023",              7308L, "BSOL",
         "19/11/2023",              7324L, "BSOL",
         "26/11/2023",              7289L, "BSOL",
         "03/12/2023",              7083L, "BSOL",
         "10/12/2023",              6912L, "BSOL",
         "17/12/2023",              6565L, "BSOL",
         "24/12/2023",              6417L, "BSOL",
         "31/12/2023",              6467L, "BSOL",
         "07/01/2024",              6645L, "BSOL",
         "14/01/2024",              6483L, "BSOL",
         "21/01/2024",              6406L, "BSOL",
         "28/01/2024",              6298L, "BSOL",
         "04/02/2024",              5116L, "BSOL",
         "11/02/2024",              6212L, "BSOL",
         "18/02/2024",              6204L, "BSOL",
         "25/02/2024",              6065L, "BSOL",
         "03/03/2024",              6105L, "BSOL",
         "10/03/2024",              5957L, "BSOL",
         "17/03/2024",              6072L, "BSOL",
         "24/03/2024",              6056L, "BSOL",
         "31/03/2024",              6064L, "BSOL",
         "07/04/2024",              5922L, "BSOL",
         "14/04/2024",              6243L, "BSOL",
         "21/04/2024",              6196L, "BSOL",
         "28/04/2024",              6536L, "BSOL",
         "05/05/2024",              6607L, "BSOL",
         "12/05/2024",              6661L, "BSOL",
         "19/05/2024",              6593L, "BSOL",
         "26/05/2024",              6861L, "BSOL",
         "02/06/2024",              6767L, "BSOL",
         "09/06/2024",              6857L, "BSOL",
         "16/06/2024",              6801L, "BSOL",
         "23/06/2024",              6683L, "BSOL",
         "30/06/2024",              6457L, "BSOL",
         "07/07/2024",              6443L, "BSOL",
         "14/07/2024",              6459L, "BSOL",
         "21/07/2024",              6264L, "BSOL",
         "28/07/2024",              5917L, "BSOL",
         "04/08/2024",              6001L, "BSOL",
         "11/08/2024",              6056L, "BSOL",
         "18/08/2024",              5964L, "BSOL",
         "25/08/2024",              5911L, "BSOL",
         "01/09/2024",              5827L, "BSOL",
         "08/09/2024",              5811L, "BSOL",
         "15/09/2024",              5317L, "BSOL",
         "22/09/2024",              5597L, "BSOL",
         "29/09/2024",              5470L, "BSOL",
         "02/10/2022",              7517L,  "UHB",
         "09/10/2022",              7562L,  "UHB",
         "16/10/2022",              7660L,  "UHB",
         "23/10/2022",              7660L,  "UHB",
         "30/10/2022",              7741L,  "UHB",
         "06/11/2022",              7715L,  "UHB",
         "13/11/2022",              7777L,  "UHB",
         "20/11/2022",              7757L,  "UHB",
         "27/11/2022",              7747L,  "UHB",
         "04/12/2022",              7740L,  "UHB",
         "11/12/2022",              7750L,  "UHB",
         "18/12/2022",              7694L,  "UHB",
         "25/12/2022",              7633L,  "UHB",
         "01/01/2023",              7572L,  "UHB",
         "08/01/2023",              7526L,  "UHB",
         "15/01/2023",              7451L,  "UHB",
         "22/01/2023",              4048L,  "UHB",
         "05/02/2023",              7125L,  "UHB",
         "12/02/2023",              7084L,  "UHB",
         "19/02/2023",              4581L,  "UHB",
         "26/02/2023",              6969L,  "UHB",
         "05/03/2023",              7109L,  "UHB",
         "12/03/2023",              7110L,  "UHB",
         "19/03/2023",              7226L,  "UHB",
         "26/03/2023",              7217L,  "UHB",
         "02/04/2023",              7168L,  "UHB",
         "09/04/2023",              7218L,  "UHB",
         "16/04/2023",              7151L,  "UHB",
         "23/04/2023",              7179L,  "UHB",
         "30/04/2023",              7135L,  "UHB",
         "07/05/2023",              6943L,  "UHB",
         "14/05/2023",              6910L,  "UHB",
         "21/05/2023",              6827L,  "UHB",
         "28/05/2023",              6870L,  "UHB",
         "04/06/2023",              6715L,  "UHB",
         "11/06/2023",              6822L,  "UHB",
         "18/06/2023",              6854L,  "UHB",
         "25/06/2023",              6803L,  "UHB",
         "02/07/2023",              6725L,  "UHB",
         "09/07/2023",              6732L,  "UHB",
         "16/07/2023",              6776L,  "UHB",
         "23/07/2023",              6726L,  "UHB",
         "30/07/2023",              6633L,  "UHB",
         "06/08/2023",              6488L,  "UHB",
         "13/08/2023",              6487L,  "UHB",
         "20/08/2023",              6496L,  "UHB",
         "27/08/2023",              6463L,  "UHB",
         "03/09/2023",              6383L,  "UHB",
         "10/09/2023",              6270L,  "UHB",
         "17/09/2023",              6290L,  "UHB",
         "24/09/2023",              6444L,  "UHB",
         "01/10/2023",              6213L,  "UHB",
         "08/10/2023",              6090L,  "UHB",
         "15/10/2023",              6111L,  "UHB",
         "22/10/2023",              5983L,  "UHB",
         "29/10/2023",              5715L,  "UHB",
         "05/11/2023",              5838L,  "UHB",
         "12/11/2023",              5783L,  "UHB",
         "19/11/2023",              5790L,  "UHB",
         "26/11/2023",              5832L,  "UHB",
         "03/12/2023",              5696L,  "UHB",
         "10/12/2023",              5521L,  "UHB",
         "17/12/2023",              5183L,  "UHB",
         "24/12/2023",              5082L,  "UHB",
         "31/12/2023",              5110L,  "UHB",
         "07/01/2024",              5274L,  "UHB",
         "14/01/2024",              5148L,  "UHB",
         "21/01/2024",              5073L,  "UHB",
         "28/01/2024",              5010L,  "UHB",
         "04/02/2024",              4982L,  "UHB",
         "11/02/2024",              4882L,  "UHB",
         "18/02/2024",              4889L,  "UHB",
         "25/02/2024",              4778L,  "UHB",
         "03/03/2024",              4823L,  "UHB",
         "10/03/2024",              4764L,  "UHB",
         "17/03/2024",              4910L,  "UHB",
         "24/03/2024",              4891L,  "UHB",
         "31/03/2024",              4949L,  "UHB",
         "07/04/2024",              4792L,  "UHB",
         "14/04/2024",              5125L,  "UHB",
         "21/04/2024",              5229L,  "UHB",
         "28/04/2024",              5488L,  "UHB",
         "05/05/2024",              5600L,  "UHB",
         "12/05/2024",              5670L,  "UHB",
         "19/05/2024",              5749L,  "UHB",
         "26/05/2024",              5945L,  "UHB",
         "02/06/2024",              5896L,  "UHB",
         "09/06/2024",              6020L,  "UHB",
         "16/06/2024",              5966L,  "UHB",
         "23/06/2024",              5887L,  "UHB",
         "30/06/2024",              5641L,  "UHB",
         "07/07/2024",              5660L,  "UHB",
         "14/07/2024",              5657L,  "UHB",
         "21/07/2024",              5504L,  "UHB",
         "28/07/2024",              5190L,  "UHB",
         "04/08/2024",              5339L,  "UHB",
         "11/08/2024",              5425L,  "UHB",
         "18/08/2024",              5357L,  "UHB",
         "25/08/2024",              5339L,  "UHB",
         "01/09/2024",              5269L,  "UHB",
         "08/09/2024",              5286L,  "UHB",
         "15/09/2024",              5195L,  "UHB",
         "22/09/2024",              5028L,  "UHB",
         "29/09/2024",              4907L,  "UHB",
         "06/10/2024",              4910L,  "UHB",
         "13/10/2024",              4912L,  "UHB",
         "20/10/2024",              4848L,  "UHB",
         "27/10/2024",              4840L,  "UHB",
         "03/11/2024",              4797L,  "UHB",
         "02/10/2022",              2661L, "BWCH",
         "09/10/2022",                 NA, "BWCH",
         "16/10/2022",              2762L, "BWCH",
         "23/10/2022",              2839L, "BWCH",
         "30/10/2022",              2930L, "BWCH",
         "06/11/2022",              2985L, "BWCH",
         "13/11/2022",              3027L, "BWCH",
         "20/11/2022",              3015L, "BWCH",
         "27/11/2022",              2992L, "BWCH",
         "04/12/2022",              3020L, "BWCH",
         "11/12/2022",              3027L, "BWCH",
         "18/12/2022",              2988L, "BWCH",
         "25/12/2022",              3026L, "BWCH",
         "01/01/2023",              3064L, "BWCH",
         "08/01/2023",              3098L, "BWCH",
         "15/01/2023",              3178L, "BWCH",
         "22/01/2023",              2875L, "BWCH",
         "29/01/2023",                 NA, "BWCH",
         "05/02/2023",              3281L, "BWCH",
         "12/02/2023",              3282L, "BWCH",
         "19/02/2023",                 NA, "BWCH", # censored due to <10
         "26/02/2023",              1281L, "BWCH",
         "05/03/2023",              3250L, "BWCH",
         "12/03/2023",              3280L, "BWCH",
         "19/03/2023",              3181L, "BWCH",
         "26/03/2023",              3124L, "BWCH",
         "02/04/2023",              3155L, "BWCH",
         "09/04/2023",              3099L, "BWCH",
         "16/04/2023",              3100L, "BWCH",
         "23/04/2023",              3060L, "BWCH",
         "30/04/2023",              2904L, "BWCH",
         "07/05/2023",              2916L, "BWCH",
         "14/05/2023",              2895L, "BWCH",
         "21/05/2023",              2774L, "BWCH",
         "28/05/2023",              2693L, "BWCH",
         "04/06/2023",              2623L, "BWCH",
         "11/06/2023",              2506L, "BWCH",
         "18/06/2023",              2478L, "BWCH",
         "25/06/2023",              2440L, "BWCH",
         "02/07/2023",              2339L, "BWCH",
         "09/07/2023",              2323L, "BWCH",
         "16/07/2023",              2279L, "BWCH",
         "23/07/2023",              2258L, "BWCH",
         "30/07/2023",              2281L, "BWCH",
         "07/08/2023",              2214L, "BWCH",
         "13/08/2023",              2179L, "BWCH",
         "20/08/2023",              2106L, "BWCH",
         "28/08/2023",              2070L, "BWCH",
         "03/09/2023",              2058L, "BWCH",
         "10/09/2023",              2003L, "BWCH",
         "17/09/2023",              1872L, "BWCH",
         "24/09/2023",              1789L, "BWCH",
         "01/10/2023",              1744L, "BWCH",
         "08/10/2023",              1699L, "BWCH",
         "15/10/2023",              1642L, "BWCH",
         "22/10/2023",              1535L, "BWCH",
         "29/10/2023",              1479L, "BWCH",
         "05/11/2023",              1480L, "BWCH",
         "12/11/2023",              1407L, "BWCH",
         "19/11/2023",              1415L, "BWCH",
         "26/11/2023",              1339L, "BWCH",
         "03/12/2023",              1287L, "BWCH",
         "10/12/2023",              1282L, "BWCH",
         "17/12/2023",              1292L, "BWCH",
         "24/12/2023",              1241L, "BWCH",
         "31/12/2023",              1264L, "BWCH",
         "07/01/2024",              1271L, "BWCH",
         "14/01/2024",              1228L, "BWCH",
         "21/01/2024",              1206L, "BWCH",
         "28/01/2024",              1150L, "BWCH",
         "04/02/2024",                 NA, "BWCH",
         "11/02/2024",              1186L, "BWCH",
         "18/02/2024",              1171L, "BWCH",
         "25/02/2024",              1133L, "BWCH",
         "03/03/2024",              1131L, "BWCH",
         "10/03/2024",              1057L, "BWCH",
         "17/03/2024",              1029L, "BWCH",
         "24/03/2024",              1029L, "BWCH",
         "31/03/2024",               989L, "BWCH",
         "07/04/2024",               996L, "BWCH",
         "14/04/2024",               983L, "BWCH",
         "21/04/2024",               965L, "BWCH",
         "28/04/2024",               936L, "BWCH",
         "05/05/2024",               899L, "BWCH",
         "12/05/2024",               891L, "BWCH",
         "19/05/2024",               843L, "BWCH",
         "26/05/2024",               811L, "BWCH",
         "02/06/2024",               756L, "BWCH",
         "09/06/2024",               719L, "BWCH",
         "16/06/2024",               719L, "BWCH",
         "23/06/2024",               685L, "BWCH",
         "30/06/2024",               699L, "BWCH",
         "07/07/2024",               681L, "BWCH",
         "14/07/2024",               691L, "BWCH",
         "21/07/2024",               652L, "BWCH",
         "28/07/2024",               619L, "BWCH",
         "04/08/2024",               552L, "BWCH",
         "11/08/2024",               519L, "BWCH",
         "18/08/2024",               498L, "BWCH",
         "25/08/2024",               445L, "BWCH",
         "01/09/2024",               438L, "BWCH",
         "08/09/2024",               399L, "BWCH",
         "15/09/2024",                 NA, "BWCH",
         "22/09/2024",               442L, "BWCH",
         "29/09/2024",               424L, "BWCH"
    )






current_WL_gynae$Week_Ending_Date = as.Date(current_WL_gynae$Week_Ending_Date, "%d/%m/%Y")

current_WL_gynae %>% 
  #pivot_longer(cols = -Week_Ending_Date) %>% 
  ggplot(aes(x=Week_Ending_Date, y = Pathways_Quantity, col = Org, group = Org)) +
  geom_line()+
  geom_smooth()+
  scale_colour_viridis_d("Group")+
  scale_y_continuous("Open Pathways",labels = comma)+
  scale_x_date("Week Ending Date", date_labels = "%b-%y", date_breaks = "3 month")+
  labs(title = "Open Gynaegology pathways per week",
       subtitle = "Weekly reported data, and smoothed trend") +
  theme_minimal()+
  theme(plot.title = element_text(face="bold"))
